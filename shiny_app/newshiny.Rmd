---
title: "Shiny Graph"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
runtime: shiny
---


```{r setup, include=FALSE}
library(flexdashboard)
library(tidyverse)
library(readxl)
library(patchwork)
library(rvest)
library(httr)
library(plotly)
```



```{r,message=FALSE}
squrriel = read_csv("/Users/junyin/Desktop/data science/p8105_final/data/2018_Central_Park_Squirrel_Census_-_Squirrel_Data.csv") %>% 
janitor::clean_names()  
```


 
```{r,message=FALSE}
squrriel_plot = read_csv("/Users/junyin/Desktop/data science/p8105_final/data/2018_Central_Park_Squirrel_Census_-_Squirrel_Data.csv") %>% 
janitor::clean_names() %>% 
mutate(age_group = ifelse(age %in% "Adult","Adult",ifelse(age %in% "Juvenile","Juvenile","Unknown")),
      age_group = fct_relevel(as.factor(age_group),c("Juvenile","Adult","Unknown")),
      location = fct_relevel(as.factor(location),c("Above Ground","Ground Plane")),
      primary_fur_color = fct_relevel(as.factor(primary_fur_color),c("Cinnamon","Gray","Black"))) %>% 
separate(date,into=c('day','year'),sep=4) %>% 
separate(day,into = c('month','Date'), sep=2) %>% 
mutate(Day = recode(Date, "06"="Day1", "07"="Day2", "08"="Day3", "10"="Day4", "12"="Day5", "13"="Day6", "14"="Day7", "17"="Day8", "18"="Day9", "19"="Day10", "20"="Day11"),
       Day = fct_relevel(Day, c("Day1", "Day2", "Day3", "Day4", "Day5", "Day6", "Day7", "Day8", "Day9", "Day10", "Day11"))) %>% 
  group_by(Day, age_group) %>% 
  summarise(
    running = sum(running == "TRUE"),
    chasing = sum(chasing == "TRUE"),
    climbing = sum(climbing == "TRUE"),
    eating = sum(eating == "TRUE"),
    approaches = sum(approaches == "TRUE"),
    foraging = sum(foraging == "TRUE"),
    indifferent = sum(indifferent == "TRUE"),
    kuks = sum(kuks == "TRUE"),
    aquaas = sum(quaas == "TRUE"),
    runs_from = sum(runs_from == "TRUE"),
    tail_flags = sum(tail_flags == "TRUE"),
    tail_twitches = sum( tail_twitches== "TRUE")
    ) %>% 
    pivot_longer(
    running:tail_twitches,
    names_to = "activity", 
    values_to = "number_of_ture")%>%
  mutate(activity = as.factor(activity))

```



Column {.sidebar}
-----------------------------------------------------------------------


```{r}
squrriel_activity = squrriel_plot$activity %>% levels()
# selectInput widget
selectInput(
  "Activity", 
  label = h3("Squrriel Activity"),
  choices = squrriel_activity)

age = squrriel_plot$age_group %>% levels()
# selectInput widget
selectInput(
  "Age Group", 
  label = h3("Age Group"),
  choices = age)

```


Column {data-width=650}
-----------------------------------------------------------------------

### Chart A

```{r}
renderPlotly({ 
squrriel_plot %>%
  filter(
      activity == input[["Activity"]], 
      age_group == input[["Age Group"]]) %>% 
  mutate(text_label=number_of_ture)%>%
  plot_ly(x = ~Day) %>% 
    add_trace(y = ~number_of_ture, type = 'lines', mode = 'lines+markers', text = ~text_label)
})


```

Column {data-width=350}
-----------------------------------------------------------------------

### Chart B

```{r}

```

### Chart C

```{r}

```

